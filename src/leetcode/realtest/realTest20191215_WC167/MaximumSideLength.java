package leetcode.realtest.realTest20191215_WC167;

import utils.PrintUtils;

import java.util.Arrays;

public class MaximumSideLength {
    public static void main(String[] args) {
        MaximumSideLength length=new MaximumSideLength();
        int[][] mat = {{1,1,3,2,4,3,2},{1,1,3,2,4,3,2},{1,1,3,2,4,3,2}};int  threshold = 4;
        mat = new int[][]{{2,2,2,2,2},{2,2,2,2,2},{2,2,2,2,2},{2,2,2,2,2},{2,2,2,2,2}}; threshold = 1;
        mat = new int[][]{{1,0,2,2,2},{2,2,2,2,2},{2,2,2,2,2},{2,2,2,2,2},{2,2,2,2,2}}; threshold = 1;
        mat =new int[][]{{35,84,62,69,31,81,73,12,86,29,75,83,80,11,33,24,34,48,97,68,19,100,96,42,55,49,32,85,65,7,21,47},{74,100,33,44,2,36,5,64,99,93,10,51,79,42,12,61,24,56,85,9,20,23,65,4,45,26,52,54,31,22,28,59},{39,56,8,2,51,43,45,52,38,20,69,53,91,41,26,93,77,5,30,88,94,15,99,28,55,19,6,60,71,90,12,79},{81,58,9,21,89,42,37,51,62,0,70,47,34,55,96,15,22,11,68,98,14,54,38,20,6,91,44,100,40,75,2,29},{66,40,36,3,9,79,1,90,70,35,22,62,56,8,96,68,64,50,71,77,15,20,65,81,25,82,46,24,88,69,67,28},{95,18,73,69,92,60,61,29,74,27,62,16,75,38,71,59,34,99,58,8,15,30,70,32,96,79,44,77,67,66,97,83},{1,16,2,62,36,6,27,74,49,12,94,21,30,48,42,93,92,10,51,22,17,68,66,90,96,41,80,85,8,15,5,39},{81,73,58,25,57,65,33,89,37,64,0,8,92,28,59,93,13,80,21,55,72,79,26,16,15,88,91,100,45,95,18,10},{90,95,60,69,0,6,40,23,54,15,87,2,93,91,81,24,85,8,76,84,35,83,32,58,86,41,63,77,43,96,37,25},{92,55,95,47,26,42,38,19,73,53,28,86,87,41,35,11,64,59,17,74,70,49,76,51,69,27,56,98,85,66,84,93},{87,0,1,65,5,15,69,46,36,42,95,12,18,52,75,61,97,43,66,35,77,9,3,98,56,88,83,45,21,60,10,81},{12,28,22,65,52,13,38,71,54,74,29,88,81,91,4,0,31,47,40,35,56,85,14,11,73,37,32,100,64,87,17,99},{45,29,46,21,61,50,22,98,63,67,33,71,68,4,89,6,60,44,37,58,84,82,15,70,48,95,47,2,62,20,78,9},{76,56,8,27,41,24,60,48,61,50,31,93,35,71,20,66,51,75,55,87,32,3,1,28,19,83,47,84,73,70,5,30},{97,36,3,41,67,6,51,70,31,46,38,57,12,66,59,28,80,63,23,75,48,53,52,8,100,39,54,65,61,47,56,49},{82,28,57,58,31,99,50,47,70,22,91,25,20,65,54,72,80,0,76,86,44,81,66,89,38,46,95,11,88,37,48,41},{36,64,1,55,93,32,92,53,63,27,0,21,43,46,26,17,52,18,5,66,3,58,88,67,60,54,82,44,6,90,8,31},{93,15,30,86,18,66,34,54,37,65,75,51,57,10,5,91,99,50,39,94,35,100,74,28,96,17,78,3,89,20,44,72},{86,92,62,46,59,65,74,96,51,4,22,80,40,29,14,18,79,48,32,1,12,35,27,19,28,41,55,42,38,53,26,84},{61,28,67,18,7,49,6,20,65,98,74,82,88,59,73,96,12,14,8,53,3,75,35,95,29,46,0,34,5,30,42,39},{83,45,85,99,33,50,68,77,0,82,71,58,21,14,57,53,7,3,75,5,46,87,60,35,74,66,55,34,6,12,70,84},{74,88,63,2,44,65,54,36,80,6,93,39,35,24,16,33,53,43,38,41,71,26,64,95,67,28,17,98,57,23,96,56},{87,77,6,44,31,52,72,24,86,12,75,11,49,69,23,100,9,21,5,61,15,18,62,40,48,55,16,4,63,99,25,53},{71,33,46,72,17,32,82,12,75,69,13,9,22,95,26,66,88,55,64,73,78,39,23,0,90,51,40,11,34,18,86,60},{19,51,39,9,21,8,44,12,95,60,16,55,99,62,52,68,17,72,36,85,86,71,96,77,76,49,1,28,33,50,87,65},{10,73,99,62,14,84,42,36,49,71,78,6,75,92,8,97,86,11,44,85,64,93,63,12,96,91,1,76,31,79,69,48},{40,24,45,30,9,51,25,35,48,37,57,82,34,26,6,99,46,84,94,44,72,33,49,85,43,0,75,73,12,5,69,91},{91,49,2,75,43,18,41,76,50,66,9,89,63,0,38,7,12,6,80,53,27,92,26,60,22,79,46,1,10,13,74,24},{3,92,68,78,33,97,45,71,84,62,20,93,9,80,12,73,5,77,4,30,67,24,54,87,59,16,65,35,70,47,42,40},{55,61,36,6,15,73,13,30,38,96,44,60,0,56,8,50,31,100,68,35,94,26,72,99,18,34,92,12,32,1,52,84},{68,2,50,97,71,37,36,47,62,17,58,82,31,25,32,10,67,66,76,100,99,18,61,95,42,77,83,98,73,29,21,43},{14,30,66,79,70,1,97,26,49,17,10,0,58,59,37,32,50,99,5,56,54,19,3,87,23,42,61,86,64,68,55,82},{60,100,85,51,70,24,28,94,40,8,38,10,63,23,22,56,32,72,18,89,11,34,1,46,14,86,75,48,78,71,44,19},{93,25,49,71,89,11,74,78,65,54,31,2,52,38,13,64,60,99,33,79,18,1,97,40,45,67,21,88,12,6,98,69},{36,10,100,86,59,9,66,3,47,72,34,2,38,83,50,56,25,55,87,77,44,94,13,58,49,95,46,39,21,96,71,64},{88,20,1,90,92,82,38,36,26,53,15,49,77,27,75,31,72,21,81,64,16,70,30,29,40,79,43,52,9,19,73,66},{42,38,67,65,73,36,78,7,33,2,25,100,43,70,32,10,1,8,35,26,14,12,71,66,92,50,6,30,9,51,5,46},{28,37,9,79,71,82,14,25,1,77,8,13,63,64,24,12,59,40,16,34,67,78,72,41,65,38,74,98,23,99,57,44},{31,60,99,62,88,15,95,97,24,10,69,54,14,56,5,43,38,27,32,23,39,13,83,29,100,40,37,71,28,92,6,46},{53,11,59,2,81,63,83,1,48,72,57,13,61,96,34,62,25,18,55,4,66,44,16,0,99,54,70,74,23,64,97,88},{97,49,65,52,46,43,6,94,76,90,32,99,88,87,79,73,50,85,19,22,54,66,55,96,60,35,10,71,30,41,44,27},{65,9,10,92,7,44,37,19,77,75,53,4,36,56,38,6,23,39,61,46,90,20,5,24,100,86,33,57,97,11,31,85},{8,94,80,17,4,91,28,10,36,22,39,59,86,27,31,92,97,12,95,99,50,77,98,42,11,79,52,73,78,47,34,45},{4,19,38,84,96,70,72,95,74,21,15,37,45,63,36,33,46,6,80,10,1,43,69,54,79,97,60,13,27,86,20,68},{5,56,25,53,34,87,70,73,36,51,9,86,89,90,88,64,18,46,13,30,74,65,63,28,68,80,10,62,85,3,92,79},{36,1,12,4,7,75,33,65,59,10,44,80,22,14,51,9,60,26,43,29,15,17,31,82,41,0,76,88,50,83,69,63},{36,40,56,35,73,62,77,81,18,1,97,3,33,21,60,95,98,52,64,65,46,76,57,53,84,43,87,74,39,93,91,34},{35,80,15,91,4,0,36,88,77,21,86,3,32,89,82,64,10,22,85,70,13,57,41,34,96,90,46,18,25,92,2,1},{89,79,34,29,30,15,69,66,60,95,58,56,3,32,67,46,52,45,10,71,38,37,19,88,31,28,6,100,25,20,2,61},{47,49,18,52,75,98,84,8,2,11,21,43,46,35,79,82,13,64,10,96,45,51,36,30,40,26,99,34,91,42,60,22},{100,63,75,50,65,17,56,64,86,67,53,4,77,30,20,14,99,34,28,31,81,70,15,93,36,6,33,12,98,1,27,74},{12,98,46,27,93,88,56,80,21,50,99,13,84,57,58,51,0,4,26,59,38,17,1,16,5,97,43,82,92,90,86,87},{72,77,92,81,99,96,14,33,19,17,11,10,63,79,56,38,13,0,60,78,28,85,66,73,15,93,8,67,2,43,40,70},{82,46,94,66,0,76,16,45,12,37,30,24,77,91,96,95,64,26,53,58,33,98,50,60,99,43,35,31,49,97,47,75},{60,29,30,98,12,5,97,66,74,54,8,34,83,32,38,21,22,89,40,80,69,73,64,96,10,63,17,87,84,1,55,28},{7,8,15,96,55,79,18,58,65,95,92,84,19,89,98,0,77,5,51,73,37,66,29,91,90,11,42,35,2,63,76,52},{97,57,95,48,34,98,66,23,46,43,11,6,73,77,1,35,45,67,12,93,55,96,49,59,39,81,56,69,31,42,5,17},{65,51,48,17,97,4,50,32,18,2,71,28,96,23,72,77,57,1,92,99,56,93,52,84,37,95,94,81,36,26,39,79},{4,62,92,25,97,95,86,69,19,12,35,16,1,94,14,60,84,59,98,27,10,43,21,46,55,30,75,24,53,76,57,31},{92,14,27,23,52,77,41,80,36,37,56,8,96,66,17,42,81,5,69,63,32,40,7,82,30,11,9,13,0,35,10,59},{55,92,33,29,2,77,36,40,94,37,56,4,93,51,59,60,1,98,73,78,44,21,41,42,38,58,52,61,84,96,75,88},{30,72,9,38,23,90,26,80,27,41,64,78,18,5,60,3,54,47,93,21,63,89,83,88,43,48,29,67,87,4,22,86},{87,41,54,67,82,99,92,66,3,79,95,52,27,42,51,73,19,28,46,43,14,32,85,4,72,98,59,15,96,38,34,26},{5,70,12,67,54,3,64,23,84,74,17,60,81,92,82,22,21,69,7,79,73,20,43,49,16,52,57,97,89,83,98,10},{6,46,97,24,3,66,93,86,96,32,27,60,2,79,12,77,78,87,85,8,11,0,10,98,94,34,56,83,1,53,68,54},{76,81,27,14,90,43,89,54,98,65,40,79,99,19,44,75,61,34,48,5,4,94,69,95,71,53,80,64,39,92,24,23},{40,68,19,87,57,17,7,91,53,28,99,36,96,66,15,35,8,83,72,21,47,44,56,5,73,63,93,39,3,27,11,43},{98,45,1,82,96,88,66,56,58,43,23,34,79,85,57,97,7,38,94,6,21,52,12,92,89,55,4,9,71,39,8,76},{55,57,98,23,37,52,9,6,74,1,36,24,20,8,32,66,100,10,51,71,68,84,89,67,43,64,92,61,53,56,34,75},{71,7,24,6,0,78,99,45,29,4,41,97,35,18,42,76,53,27,95,91,2,17,51,72,93,34,26,92,3,30,81,44},{92,93,53,91,45,98,42,70,97,82,73,6,60,100,30,51,26,89,63,43,71,4,48,7,3,86,62,9,57,17,87,54},{16,40,85,3,57,7,64,9,63,19,11,87,39,75,70,65,53,86,32,66,68,100,62,91,30,1,93,45,38,61,58,60},{62,22,7,66,20,23,87,41,54,17,32,15,0,100,85,9,50,13,19,60,56,6,39,88,30,98,73,16,5,83,86,46},{44,29,77,72,57,73,5,50,99,9,63,70,40,20,15,84,56,6,86,87,26,1,46,24,69,78,43,89,98,41,39,94},{91,11,86,2,84,78,35,46,71,82,88,59,81,93,23,33,48,3,13,57,96,44,68,47,20,85,38,30,5,45,100,39},{60,30,31,99,77,100,3,4,73,50,10,84,64,59,13,97,27,92,61,25,52,89,53,18,46,82,44,11,2,39,20,66},{8,67,45,72,74,33,42,17,19,21,85,28,93,38,15,69,58,30,100,68,84,20,34,36,65,35,99,88,11,40,55,14},{29,12,83,54,75,17,47,53,26,59,74,49,52,61,89,70,40,45,34,97,100,80,38,2,78,37,72,10,22,98,19,76},{63,70,7,69,59,25,86,93,9,54,75,16,28,18,91,32,99,76,56,57,4,100,52,49,97,74,87,44,60,72,51,65},{54,64,16,10,20,33,84,94,87,40,36,18,91,71,39,63,55,7,50,52,96,53,66,14,46,17,81,48,15,30,57,5},{80,47,0,24,77,18,13,2,78,1,53,97,19,40,4,59,43,74,25,14,54,90,69,89,94,63,88,98,28,55,44,37},{20,50,82,3,73,78,7,55,37,1,52,54,53,8,49,22,48,74,39,70,63,31,86,44,88,43,69,58,42,18,91,14},{36,16,56,45,38,72,1,58,85,57,51,70,77,81,66,98,39,100,71,41,20,91,53,8,17,95,31,59,34,64,47,73},{51,13,90,66,89,65,99,56,63,34,10,75,93,33,17,39,42,15,82,91,23,21,97,85,31,88,2,57,50,4,32,43},{60,51,62,94,69,27,7,74,35,100,70,8,0,88,16,12,46,47,21,39,68,41,25,83,59,20,24,11,10,93,17,90},{17,5,28,99,7,24,93,61,84,10,81,50,75,48,87,86,69,20,77,40,21,54,46,47,59,92,38,39,94,62,14,56},{90,54,29,79,84,28,92,27,100,51,35,91,57,2,26,64,44,50,14,63,1,6,43,97,89,5,66,20,8,82,7,53},{65,60,77,26,3,37,71,38,67,66,40,62,95,93,48,7,36,18,19,41,88,100,34,55,52,0,9,1,20,89,70,15},{25,62,96,19,86,40,66,3,45,0,31,29,94,17,100,6,68,21,2,14,48,81,32,12,92,80,83,47,59,53,30,93},{69,75,67,88,42,28,59,49,30,97,63,6,24,52,3,40,83,44,19,31,80,21,14,0,77,55,7,10,36,98,38,99},{44,9,11,2,5,7,50,52,49,99,17,71,56,60,38,20,39,66,51,24,61,95,65,72,91,55,16,63,47,54,68,34},{31,28,74,22,0,18,37,88,50,42,83,41,21,29,4,24,14,49,23,45,58,26,66,33,60,64,1,43,51,80,70,97},{75,40,54,17,79,96,72,11,3,28,10,35,22,19,67,76,100,77,52,65,39,88,56,43,64,63,60,30,86,92,95,21},{65,21,93,64,79,24,77,49,58,57,46,89,9,63,44,72,37,99,54,41,32,59,17,66,5,82,16,40,14,22,98,34},{3,6,90,49,4,61,65,73,47,37,13,52,56,63,25,26,53,99,60,71,1,5,45,31,77,54,19,100,35,2,48,8},{13,30,60,10,46,95,21,43,54,75,0,34,63,82,44,86,81,98,15,73,57,56,100,7,78,23,42,22,69,96,48,1}};
        threshold=35000;
        int[][] temp=new int[28][mat[0].length];
        for(int i=0;i<28;i++) temp[i]= Arrays.copyOf(mat[i], mat[0].length);
        mat=temp;
//        mat=new int[][]{{1,0},{3,0}};
//        threshold=0;
        PrintUtils.print2DIntArray(mat);
//        mat = new int[][]{{18,70},{61,1},{25,85},{14,40},{11,96},{97,96},{63,45}}; threshold = 40184;
        System.out.println(length.maxSideLength(mat, threshold));
    }
    public int maxSideLength(int[][] mat, int threshold) {
        int m=mat.length, n=mat[0].length;
        int[][] presum=new int[m+1][n+1];
        for(int i=1; i<=m; i++){
            for(int j=1; j<=n; j++){
                presum[i][j]= presum[i][j-1]+mat[i-1][j-1];
            }
        }
        PrintUtils.print2DIntArray(presum);
        System.out.println("----------------------------------------");
        for(int j=1; j<=n; j++){
            for(int i=1; i<=m; i++){
                presum[i][j] += presum[i-1][j];
            }
        }
        PrintUtils.print2DIntArray(presum);
        System.out.println(m+", "+n);

        int max=0;
        for(int i=m;i>=1; i--){
            for (int j = n; j >= 1; j--) {
                int width=Math.min(i,j);
                for (int k = width; k > 0; k--) {
                    int sum=presum[i][j]-presum[i-width][j]-presum[i][j-width]+presum[i-width][j-width];
                    if(sum<=threshold){
                        max=Math.max(max, width);
                        break;
                    }
                    if(max==26) System.out.println("i="+i+", j="+j);
                }
            }
        }
        return max;
    }
}
